(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/user"],{5420:function(e,s,t){"use strict";var i=function(){var e=this,s=e.$createElement;e._self._c},a=[];t.d(s,"a",function(){return i}),t.d(s,"b",function(){return a})},"9ce7":function(e,s,t){"use strict";t.r(s);var i=t("5420"),a=t("de1c");for(var n in a)"default"!==n&&function(e){t.d(s,e,function(){return a[e]})}(n);t("afbc");var o=t("2877"),d=Object(o["a"])(a["default"],i["a"],i["b"],!1,null,null,null);s["default"]=d.exports},a42e:function(e,s,t){"use strict";(function(e){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var i,a=o(t("a096")),n=o(t("3680"));function o(e){return e&&e.__esModule?e:{default:e}}var d={data:function(){return{sexes:[{name:"男",id:1},{name:"女",id:2}],sexIndex:0,livings:getApp().globalData.livings,livingIndex:0,flats:getApp().globalData.flats,flatIndex:0,diseases:getApp().globalData.diseases,diseaseIndex:0,diseasesDetail:"",showDisDtl:!0,scares:getApp().globalData.scares,scareIndex:0,ifs:[],birthDate:"",showIfs:!0,showOther:!0,lastname:"",firstname:"",occupation:"",address:"",infoUserIndex:0,relationship:["本人"],relationshipIndex:0,phone:"",regions:getApp().globalData.regions,regionIndex:0,otherTxt:"",end:n.default.getToday(),showDelBnt:!0}},onLoad:function(e){i=this,this.ifs=getApp().globalData.ifs.slice();var s=getApp().globalData.users[e.userIndex];0!=e.userIndex&&(this.relationship=["父母亲","兄弟","姐妹","儿女","夫妻"]),this.setUserInfo(s),this.infoUserIndex=e.userIndex,e.userIndex>1?this.showDelBnt=!1:1==e.userIndex&&(this.address=getApp().globalData.users[0].address)},methods:{setUserInfo:function(e){0==e.scares?this.showIfs=!0:this.showIfs=!1;for(var s=!0,t=this.ifs,i=0;i<e.ifs.length;i++)t[i].checked=e.ifs[i],7==i&&(s=!e.ifs[i]);this.lastname=e.lastname,this.firstname=e.firstname,this.sexIndex=e.sexes,this.birthDate=e.birthDate,this.phone=e.phone,this.regionIndex=e.regions,this.address=e.address,this.occupation=e.occupation,this.livingIndex=e.livings,this.flatIndex=e.flats,this.diseaseIndex=e.diseases,this.diseasesDetail=e.diseasesDetail,5==this.diseaseIndex&&(this.showDisDtl=!1),this.scareIndex=e.scares,this.otherTxt=e.otherTxt,this.relationshipIndex=e.relationship,this.ifs=t,this.showOther=s},bindDateChange:function(e){this.birthDate=e.target.value},bindLivingChange:function(e){this.livingIndex=e.target.value},bindFlatChange:function(e){this.flatIndex=e.target.value},bindDiseaseChange:function(e){this.diseaseIndex=e.target.value,this.showDisDtl=!0,5==this.diseaseIndex?this.showDisDtl=!1:this.diseasesDetail=""},bindSexChange:function(e){this.sexIndex=e.target.value},ifsChange:function(e){this.ifs[e].checked=!this.ifs[e].checked,this.showOther=!this.ifs[7].checked},submitForm:function(){var s=this.lastname;if(""!=s){var t=this.firstname;if(""!=t){var n=this.sexIndex,o=this.birthDate,d=this.phone;if(""!=d){var r=this.regionIndex,l=this.address;if(""!=l){for(var h=this.occupation,u=this.livingIndex,c=this.flatIndex,f=this.diseaseIndex,g=this.diseasesDetail,p=this.scareIndex,x=this.ifs,m=[],b=[],I=0;I<x.length;I++)m[I]=x[I].checked,m[I]&&b.push(x[I].name);var v=this.otherTxt,D=this.relationshipIndex,w={id:0,lastname:s,firstname:t,sexes:n,birthDate:o,phone:d,regions:r,address:l,occupation:h,livings:u,flats:c,diseases:f,diseasesDetail:g,scares:p,ifs:m,otherTxt:v,relationship:D};e.login({provider:"weixin",success:function(e){var x=e.code,m={};m.id=getApp().globalData.users[i.infoUserIndex].id,m.lastname=s,m.firstname=t,n=i.sexes[n].id,m.id_gender=n,m.birthday=o,m.user_name=x,m.occupation=h,m.living_status=i.livings[u],m.home_type=i.flats[c],m.health_status=i.diseases[f],m.health_status_detail=g,m.special_care=i.scares[p],""!=v&&b.push(v),m.special_care_detail=b,m.id_global_demand=i.regions[r].id,m.address=l,m.phone=d,m.relationship=i.relationship[D],m.nickName=getApp().globalData.nickName,0==i.infoUserIndex?0==m.id?a.default.createCustomer(function(e){i.addUser(e.data.customer,w,!0)},m):a.default.updateUser(function(e){w.id=m.id,i.updateUser(e,w)},m):0==m.id?(m.id=getApp().globalData.users[0].id,a.default.addCustomer(function(e){i.addUser(e.data.address,w,!1)},m)):(m.main=getApp().globalData.users[0].id,a.default.updateMember(function(e){w.id=m.id,i.updateUser(e,w)},m))}})}else e.showToast({title:"请填写详细地址",image:"../../static/info-icon.png",mask:!0})}else e.showToast({title:"请填写手机号",image:"../../static/info-icon.png",mask:!0})}else e.showToast({title:"请填写用户名",image:"../../static/info-icon.png",mask:!0})}else e.showToast({title:"请填写用户姓",image:"../../static/info-icon.png",mask:!0})},addUser:function(s,t,i){void 0!==s?(t.id=s.id,i?(getApp().globalData.users[0]=t,getApp().globalData.isNewUser=!1):getApp().globalData.users.push(t),e.showToast({title:"添加成功",image:"../../static/info-icon.png",mask:!0}),setTimeout(function(){e.switchTab({url:"/pages/userList/userList"})},2e3)):e.showToast({title:"添加失败",image:"../../static/info-icon.png",mask:!0})},updateUser:function(s,t){400==s.statusCode?e.showToast({title:"修改失败",image:"../../static/info-icon.png",mask:!0}):(getApp().globalData.users[i.infoUserIndex]=t,e.showToast({title:"修改成功",image:"../../static/info-icon.png",mask:!0}),setTimeout(function(){e.switchTab({url:"/pages/userList/userList"})},2e3))},bindScareChange:function(e){0==e.detail.value?(this.ifs.forEach(function(e){e.checked=!1}),this.otherTxt="",this.showIfs=!0,this.showOther=!0):this.showIfs=!1,this.scareIndex=e.detail.value},bindRelationShipChange:function(e){this.relationshipIndex=e.detail.value},bindRegionChange:function(e){this.regionIndex=e.detail.value},deleteUser:function(s){var t=getApp().globalData.users[this.infoUserIndex].id,n={id:t};e.showModal({title:"提示",content:"是否删除该信息",success:function(s){s.confirm&&a.default.deleteUser(function(s){200==s.statusCode?(getApp().globalData.users.splice(i.infoUserIndex,1),e.showToast({title:"删除成功",image:"../../static/info-icon.png",mask:!0}),setTimeout(function(){e.switchTab({url:"/pages/userList/userList"})},2e3)):e.showToast({title:"删除失败",image:"../../static/info-icon.png",mask:!0})},n)}})}}};s.default=d}).call(this,t("543d")["default"])},afbc:function(e,s,t){"use strict";var i=t("b677"),a=t.n(i);a.a},b677:function(e,s,t){},d304:function(e,s,t){"use strict";(function(e){t("faf8"),t("921b");i(t("66fd"));var s=i(t("9ce7"));function i(e){return e&&e.__esModule?e:{default:e}}e(s.default)}).call(this,t("543d")["createPage"])},de1c:function(e,s,t){"use strict";t.r(s);var i=t("a42e"),a=t.n(i);for(var n in i)"default"!==n&&function(e){t.d(s,e,function(){return i[e]})}(n);s["default"]=a.a}},[["d304","common/runtime","common/vendor"]]]);