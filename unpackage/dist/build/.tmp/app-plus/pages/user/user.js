(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/user"],{"4f5d":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},a=[];s.d(t,"a",function(){return i}),s.d(t,"b",function(){return a})},"9ce7":function(e,t,s){"use strict";s.r(t);var i=s("4f5d"),a=s("de1c");for(var n in a)"default"!==n&&function(e){s.d(t,e,function(){return a[e]})}(n);s("afbc");var o=s("2877"),r=Object(o["a"])(a["default"],i["a"],i["b"],!1,null,null,null);t["default"]=r.exports},a42e:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,a=o(s("a096")),n=o(s("3680"));function o(e){return e&&e.__esModule?e:{default:e}}var r={data:function(){return{sexes:[{name:"男",id:1},{name:"女",id:2}],sexIndex:0,livings:getApp().globalData.livings,livingIndex:0,flats:getApp().globalData.flats,flatIndex:0,diseases:getApp().globalData.diseases,diseaseIndex:0,scares:getApp().globalData.scares,scareIndex:0,ifs:[],birthDate:"",showIfs:!0,showOther:!0,lastname:"",firstname:"",occupation:"",address:"",infoUsers:["本人信息","新增人员"],infoUserIndex:0,relationship:["本人"],relationshipIndex:0,phone:"",regions:getApp().globalData.regions,regionIndex:0,otherTxt:"",end:n.default.getToday(),showDelBnt:!0}},onLoad:function(){i=this,this.ifs=getApp().globalData.ifs.slice();var e=getApp().globalData.users[0];if(this.setUserInfo(e),getApp().globalData.isNewUser)this.infoUsers=["本人信息"];else{var t=getApp().globalData.users;if(t.length>2)for(var s=2;s<t.length;s++){var a=t[s].lastname+t[s].firstname;this.infoUsers.push(a)}}},methods:{setUserInfo:function(e){0==e.scares?this.showIfs=!0:this.showIfs=!1;for(var t=!0,s=this.ifs,i=0;i<e.ifs.length;i++)s[i].checked=e.ifs[i],7==i&&(t=!e.ifs[i]);this.lastname=e.lastname,this.firstname=e.firstname,this.sexIndex=e.sexes,this.birthDate=e.birthDate,this.phone=e.phone,this.regionIndex=e.regions,this.address=e.address,this.occupation=e.occupation,this.livingIndex=e.livings,this.flatIndex=e.flats,this.diseaseIndex=e.diseases,this.scareIndex=e.scares,this.otherTxt=e.otherTxt,this.relationshipIndex=e.relationship,this.ifs=s,this.showOther=t},bindDateChange:function(e){this.birthDate=e.target.value},bindLivingChange:function(e){this.livingIndex=e.target.value},bindFlatChange:function(e){this.flatIndex=e.target.value},bindDiseaseChange:function(e){this.diseaseIndex=e.target.value},bindSexChange:function(e){this.sexIndex=e.target.value},ifsChange:function(e){this.ifs[e].checked=!this.ifs[e].checked,this.showOther=!this.ifs[7].checked},submitForm:function(){var t=this.lastname;if(""!=t){var s=this.firstname;if(""!=s){var n=this.sexIndex,o=this.birthDate,r=this.phone;if(""!=r){var d=this.regionIndex,l=this.address;if(""!=l){for(var h=this.occupation,f=this.livingIndex,u=this.flatIndex,c=this.diseaseIndex,g=this.scareIndex,p=this.ifs,x=[],v=[],b=0;b<p.length;b++)x[b]=p[b].checked,x[b]&&v.push(p[b].name);var I=this.otherTxt,m=this.relationshipIndex,U={id:0,lastname:t,firstname:s,sexes:n,birthDate:o,phone:r,regions:d,address:l,occupation:h,livings:f,flats:u,diseases:c,scares:g,ifs:x,otherTxt:I,relationship:m};e.login({provider:"weixin",success:function(p){var x=p.code,b={};b.id=getApp().globalData.users[i.infoUserIndex].id,b.lastname=t,b.firstname=s,n=i.sexes[n].id,b.id_gender=n,b.birthday=o,b.user_name=x,b.occupation=h,b.living_status=i.livings[f],b.home_type=i.flats[u],b.health_status=i.diseases[c],b.special_care=i.scares[g],""!=I&&v.push(I),b.special_care_detail=v,b.id_global_demand=i.regions[d].id,b.address=l,b.phone=r,b.relationship=i.relationship[m],0==i.infoUserIndex?0==b.id?a.default.createCustomer(function(t){void 0!==t.data.customer?(U.id=t.data.customer.id,getApp().globalData.users[0]=U,1==i.infoUsers.length&&(i.infoUsers=["本人信息","新增人员"],getApp().globalData.isNewUser=!1),e.showToast({title:"提交成功",image:"../../static/info-icon.png",duration:2e3})):e.showToast({title:"提交失败",image:"../../static/info-icon.png",duration:2e3})},b):a.default.updateUser(function(t){400==t.statusCode?e.showToast({title:"修改失败",image:"../../static/info-icon.png",duration:2e3}):(U.id=b.id,getApp().globalData.users[i.infoUserIndex]=U,e.showToast({title:"修改成功",image:"../../static/info-icon.png",duration:2e3}))},b):0==b.id?(b.id=getApp().globalData.users[0].id,a.default.addCustomer(function(a){if(void 0!==a.data.address){U.id=a.data.address.id;var n=t+s;i.addUser(n,U)}else e.showToast({title:"提交失败",image:"../../static/info-icon.png",duration:2e3})},b)):(b.main=getApp().globalData.users[0].id,a.default.updateMember(function(t){400==t.statusCode?e.showToast({title:"修改失败",image:"../../static/info-icon.png",duration:2e3}):(U.id=b.id,i.updateUser(U))},b))}})}else e.showToast({title:"请填写详细地址",image:"../../static/info-icon.png",duration:2e3})}else e.showToast({title:"请填写手机号",image:"../../static/info-icon.png",duration:2e3})}else e.showToast({title:"请填写用户名",image:"../../static/info-icon.png",duration:2e3})}else e.showToast({title:"请填写用户姓",image:"../../static/info-icon.png",duration:2e3})},addUser:function(t,s){var i=this.infoUsers;i.push(t),this.infoUsers=i,this.infoUserIndex=0,this.relationship=["本人"],getApp().globalData.users.push(s),this.setUserInfo(getApp().globalData.users[0]),e.showToast({title:"添加成功",image:"../../static/info-icon.png",duration:2e3})},updateUser:function(t){var s=t.lastname+t.firstname,i=this.infoUsers;i[this.infoUserIndex]=s,this.infoUsers=i,getApp().globalData.users[this.infoUserIndex]=t,e.showToast({title:"修改成功",image:"../../static/info-icon.png",duration:2e3})},bindScareChange:function(e){0==e.detail.value?(getApp().globalData.users[i.infoUserIndex].ifs=[!1,!1,!1,!1,!1,!1,!1,!1],getApp().globalData.users[i.infoUserIndex].otherTxt="",i.setUserInfo(getApp().globalData.users[i.infoUserIndex]),this.showIfs=!0):this.showIfs=!1,this.scareIndex=e.detail.value},bindInfoUserChange:function(e){0==e.detail.value?(this.relationship=["本人"],this.showDelBnt=!0):(this.showDelBnt=!0,this.relationship=["父母亲","兄弟","姐妹","儿女"],1!=e.detail.value&&(this.showDelBnt=!1));var t=getApp().globalData.users[e.detail.value];this.setUserInfo(t),this.infoUserIndex=e.detail.value},bindRelationShipChange:function(e){this.relationshipIndex=e.detail.value},bindRegionChange:function(e){this.regionIndex=e.detail.value},deleteUser:function(t){var s=getApp().globalData.users[this.infoUserIndex].id,n={id:s};e.showModal({title:"提示",content:"是否删除该信息",success:function(t){t.confirm&&a.default.deleteUser(function(t){if(200==t.statusCode){getApp().globalData.users.splice(i.infoUserIndex,1),i.setUserInfo(getApp().globalData.users[0]);var s=i.infoUsers;s.splice(i.infoUserIndex,1),i.infoUsers=s,i.infoUserIndex=0,i.showDelBnt=!0,i.relationship=["本人"],e.showToast({title:"删除成功",image:"../../static/info-icon.png",duration:2e3})}else e.showToast({title:"删除失败",image:"../../static/info-icon.png",duration:2e3})},n)}})}}};t.default=r}).call(this,s("6e42")["default"])},afbc:function(e,t,s){"use strict";var i=s("b677"),a=s.n(i);a.a},b677:function(e,t,s){},d304:function(e,t,s){"use strict";(function(e){s("faf8"),s("921b");i(s("66fd"));var t=i(s("9ce7"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("6e42")["createPage"])},de1c:function(e,t,s){"use strict";s.r(t);var i=s("a42e"),a=s.n(i);for(var n in i)"default"!==n&&function(e){s.d(t,e,function(){return i[e]})}(n);t["default"]=a.a}},[["d304","common/runtime","common/vendor"]]]);